setwd("C:/Workspace/github_repos/Petrogale_allometry")
library(geomorph)
library(geomorph)
library(landvR)
library(geomorph)
library(landvR)
IMPORT SHAPE DATA
library(geomorph)
library(landvR)
library(geomorph)
library(landvR)
IMPORT SHAPE DATA
load("allometry_tests.rda")
ind <- dimnames(alldata)[[3]]
pet_sym <- bilat.symmetry(alldata, ind=ind, land.pairs = sym, object.sym=T, curves=slide)
gpa <- gpagen(alldata)
size <- gpa$Csize
allom <- procD.lm(pet_sym$symm.shape~log(size), iter=999); summary(allom)
allom_plot <- plot(allom, type = "regression", predictor = log(size),
reg.type = "RegScore", pch = iconsPCA, bg=colsPCA,
xlab = "log(centroid size)", ylab = "Regression score", cex=2)
allom_plot <- plot(allom, type = "regression", predictor = log(size),
reg.type = "RegScore", pch = iconsPCA, bg=colsPCA,
xlab = "log(centroid size)", ylab = "Regression score", cex=2)
preds <- shape.predictor(allom$GM$fitted, x = allom_plot$PredLine,
predmin = min(allom_plot$PredLine),
predmax = max(allom_plot$PredLine))
differences <- coordinates.difference(coordinates = preds$predmax,
reference = preds$predmin, type = "spherical")
procrustes.var.plot(preds$predmax, preds$predmin, col = heat.colors, col.val = differences[[1]][1:150], magnitude = 1, pt.size = 1)
allomspec <- procD.lm(pet_sym$symm.shape~log(size)*speciesnames, iter=999)
plot2 <- plot(plot1$RegScore~log(size), xlab = "log(cranial centroid size)", ylab="Shape regression score", method = "RegScore", pch = iconsPCA, bg=colsPCA, cex=2, main="shape~log(cranial centroid size")
plot2 <- plot(allom_plot$RegScore~log(size), xlab = "log(cranial centroid size)", ylab="Shape regression score", method = "RegScore", pch = iconsPCA, bg=colsPCA, cex=2, main="shape~log(cranial centroid size")
col <- c("lightblue","red","red4","purple","red4","purple","purple4","blue","green","lightblue","purple4","orange","turquoise","yellow","lightblue","red","orange")
lm_temp <- NULL
xcoords <- vector()
ycoords <- vector ()
for (i in 1: length(levels (speciesnames))){
xcoords <- subset(log(size), speciesnames == levels (speciesnames)[i] )
ycoords <- subset(allom_plot$RegScore, speciesnames == levels (speciesnames)[i])
lm_temp <- lm(ycoords~xcoords)
segments(min(xcoords), lm_temp$coefficients[1] + lm_temp$coefficients[2] *min(xcoords), max(xcoords), lm_temp$coefficients[1] + lm_temp$coefficients[2] *max(xcoords), lwd = 4, col= col[i])
}
plot1 <- plotAllometry(allomspec, size = size, logsz = TRUE,
method = "RegScore", pch = iconsPCA, bg=colsPCA, cex=2)
summary(allomspec)
allomspec_plot <- plotAllometry(allomspec, size = size, logsz = TRUE,
method = "RegScore", pch = iconsPCA, bg=colsPCA, cex=2)
plot2 <- plot(allomspec_plot$RegScore~log(size), xlab = "log(cranial centroid size)", ylab="Shape regression score", method = "RegScore", pch = iconsPCA, bg=colsPCA, cex=2)
plot2 <- plot(allomspec_plot$RegScore~log(size), xlab = "log(cranial centroid size)", ylab="Shape regression score", method = "RegScore", pch = iconsPCA, bg=colsPCA, cex=2, main="shape~log(cranial centroid size)*species")
for (i in 1: length(levels (speciesnames))){
xcoords <- subset(log(size), speciesnames == levels (speciesnames)[i] )
ycoords <- subset(allomspec_plot$RegScore, speciesnames == levels (speciesnames)[i])
lm_temp <- lm(ycoords~xcoords)
segments(min(xcoords), lm_temp$coefficients[1] + lm_temp$coefficients[2] *min(xcoords), max(xcoords), lm_temp$coefficients[1] + lm_temp$coefficients[2] *max(xcoords), lwd = 4, col= col[i])
}
anova(allomspec) # significant interaction (Rsq=0.031, p=0.001)
summary(allomspec)
pw<-pairwise(allomspec,groups=speciesnames, covariate = log(size))
pw_sum <- summary(pw)
pw_sum
test <- procD.lm(pet_sym$symm.shape ~ log(size)*speciesnames, RRPP=T)
summary(test)
summary(fit)
summary(allomspec)
test2 <- advanced.procD.lm(pet_sym$symm.shape~log(size)+speciesnames, ~ log(size)*speciesnames, groups=~speciesnames, slope=~log(size), angle.type="deg")
test2 <- procD.lm(pet_sym$symm.shape~log(size)+speciesnames, ~ log(size)*speciesnames, groups=~speciesnames, slope=~log(size), angle.type="deg")
pw_sum <- summary(pw)
pw_sum
pw
summary(pw)
pw_sum$angle.type
?pairwise
angle<-summary(pw,test="DL",angle.type="deg")
Angle$summary.table
angle$summary.table
angle<-summary(pw,test="VC",angle.type="deg")
angle$summary.table
speciesgp <- coords.subset(alldata, speciesnames)
PCA <- gm.prcomp(pet_sym$symm.shape)
