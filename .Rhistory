reference = preds$predmin, type = "spherical")
ind <- dimnames(speciesgp$Petrogale_herberti)[[3]]
pet_sym <- bilat.symmetry(speciesgp$Petrogale_herberti, ind=ind, land.pairs = sym, object.sym=T, curves=slide)
gpa <- gpagen(speciesgp$Petrogale_herberti)
size <- gpa$Csize
range(size)
allom <- procD.lm(pet_sym$symm.shape~log(size), iter=999); summary(allom)
allom_plot <- plot(allom, type = "regression", predictor = log(size),
reg.type = "RegScore", pch = 22, bg="lightblue",
xlab = "log(centroid size)", ylab = "Regression score", cex=2)
preds <- shape.predictor(allom$GM$fitted, x = allom_plot$PredLine,
predmin = min(allom_plot$PredLine),
predmax = max(allom_plot$PredLine))
differences_herberti <- coordinates.difference(coordinates = preds$predmax,
reference = preds$predmin, type = "spherical")
ind <- dimnames(speciesgp$Petrogale_inornata)[[3]]
pet_sym <- bilat.symmetry(speciesgp$Petrogale_inornata, ind=ind, land.pairs = sym, object.sym=T, curves=slide)
gpa <- gpagen(speciesgp$Petrogale_inornata)
size <- gpa$Csize
range(size)
allom <- procD.lm(pet_sym$symm.shape~log(size), iter=999); summary(allom)
allom_plot <- plot(allom, type = "regression", predictor = log(size),
reg.type = "RegScore", pch = 22, bg="lightblue",
xlab = "log(centroid size)", ylab = "Regression score", cex=2)
preds <- shape.predictor(allom$GM$fitted, x = allom_plot$PredLine,
predmin = min(allom_plot$PredLine),
predmax = max(allom_plot$PredLine))
differences_inornata <- coordinates.difference(coordinates = preds$predmax,
reference = preds$predmin, type = "spherical")
ind <- dimnames(speciesgp$Petrogale_lateralis)[[3]]
pet_sym <- bilat.symmetry(speciesgp$Petrogale_lateralis, ind=ind, land.pairs = sym, object.sym=T, curves=slide)
gpa <- gpagen(speciesgp$Petrogale_lateralis)
size <- gpa$Csize
range(size)
allom <- procD.lm(pet_sym$symm.shape~log(size), iter=999); summary(allom)
allom_plot <- plot(allom, type = "regression", predictor = log(size),
reg.type = "RegScore", pch = 22, bg="lightblue",
xlab = "log(centroid size)", ylab = "Regression score", cex=2)
preds <- shape.predictor(allom$GM$fitted, x = allom_plot$PredLine,
predmin = min(allom_plot$PredLine),
predmax = max(allom_plot$PredLine))
differences_lateralis <- coordinates.difference(coordinates = preds$predmax,
reference = preds$predmin, type = "spherical")
ind <- dimnames(speciesgp$Petrogale_mareeba)[[3]]
pet_sym <- bilat.symmetry(speciesgp$Petrogale_mareeba, ind=ind, land.pairs = sym, object.sym=T, curves=slide)
gpa <- gpagen(speciesgp$Petrogale_mareeba)
size <- gpa$Csize
range(size)
allom <- procD.lm(pet_sym$symm.shape~log(size), iter=999); summary(allom)
allom_plot <- plot(allom, type = "regression", predictor = log(size),
reg.type = "RegScore", pch = 22, bg="lightblue",
xlab = "log(centroid size)", ylab = "Regression score", cex=2)
preds <- shape.predictor(allom$GM$fitted, x = allom_plot$PredLine,
predmin = min(allom_plot$PredLine),
predmax = max(allom_plot$PredLine))
differences_mareeba <- coordinates.difference(coordinates = preds$predmax,
reference = preds$predmin, type = "spherical")
ind <- dimnames(speciesgp$Petrogale_penicillata)[[3]]
pet_sym <- bilat.symmetry(speciesgp$Petrogale_penicillata, ind=ind, land.pairs = sym, object.sym=T, curves=slide)
gpa <- gpagen(speciesgp$Petrogale_penicillata)
size <- gpa$Csize
range(size)
allom <- procD.lm(pet_sym$symm.shape~log(size), iter=999); summary(allom)
allom_plot <- plot(allom, type = "regression", predictor = log(size),
reg.type = "RegScore", pch = 22, bg="lightblue",
xlab = "log(centroid size)", ylab = "Regression score", cex=2)
preds <- shape.predictor(allom$GM$fitted, x = allom_plot$PredLine,
predmin = min(allom_plot$PredLine),
predmax = max(allom_plot$PredLine))
differences_penicillata <- coordinates.difference(coordinates = preds$predmax,
reference = preds$predmin, type = "spherical")
ind <- dimnames(speciesgp$Petrogale_persephone)[[3]]
pet_sym <- bilat.symmetry(speciesgp$Petrogale_persephone, ind=ind, land.pairs = sym, object.sym=T, curves=slide)
gpa <- gpagen(speciesgp$Petrogale_persephone)
size <- gpa$Csize
range(size)
allom <- procD.lm(pet_sym$symm.shape~log(size), iter=999); summary(allom)
allom_plot <- plot(allom, type = "regression", predictor = log(size),
reg.type = "RegScore", pch = 22, bg="lightblue",
xlab = "log(centroid size)", ylab = "Regression score", cex=2)
preds <- shape.predictor(allom$GM$fitted, x = allom_plot$PredLine,
predmin = min(allom_plot$PredLine),
predmax = max(allom_plot$PredLine))
differences_persephone <- coordinates.difference(coordinates = preds$predmax,
reference = preds$predmin, type = "spherical")
ind <- dimnames(speciesgp$Petrogale_purpureicollis)[[3]]
pet_sym <- bilat.symmetry(speciesgp$Petrogale_purpureicollis, ind=ind, land.pairs = sym, object.sym=T, curves=slide)
gpa <- gpagen(speciesgp$Petrogale_purpureicollis)
size <- gpa$Csize
range(size)
allom <- procD.lm(pet_sym$symm.shape~log(size), iter=999); summary(allom)
allom_plot <- plot(allom, type = "regression", predictor = log(size),
reg.type = "RegScore", pch = 22, bg="lightblue",
xlab = "log(centroid size)", ylab = "Regression score", cex=2)
preds <- shape.predictor(allom$GM$fitted, x = allom_plot$PredLine,
predmin = min(allom_plot$PredLine),
predmax = max(allom_plot$PredLine))
differences_purpureicollis <- coordinates.difference(coordinates = preds$predmax,
reference = preds$predmin, type = "spherical")
ind <- dimnames(speciesgp$Petrogale_rothschildi)[[3]]
pet_sym <- bilat.symmetry(speciesgp$Petrogale_rothschildi, ind=ind, land.pairs = sym, object.sym=T, curves=slide)
gpa <- gpagen(speciesgp$Petrogale_rothschildi)
size <- gpa$Csize
range(size)
allom <- procD.lm(pet_sym$symm.shape~log(size), iter=999); summary(allom)
allom_plot <- plot(allom, type = "regression", predictor = log(size),
reg.type = "RegScore", pch = 22, bg="lightblue",
xlab = "log(centroid size)", ylab = "Regression score", cex=2)
preds <- shape.predictor(allom$GM$fitted, x = allom_plot$PredLine,
predmin = min(allom_plot$PredLine),
predmax = max(allom_plot$PredLine))
differences_rothschildi <- coordinates.difference(coordinates = preds$predmax,
reference = preds$predmin, type = "spherical")
ind <- dimnames(speciesgp$Petrogale_shamani)[[3]]
pet_sym <- bilat.symmetry(speciesgp$Petrogale_shamani, ind=ind, land.pairs = sym, object.sym=T, curves=slide)
gpa <- gpagen(speciesgp$Petrogale_shamani)
size <- gpa$Csize
range(size)
allom <- procD.lm(pet_sym$symm.shape~log(size), iter=999); summary(allom)
allom_plot <- plot(allom, type = "regression", predictor = log(size),
reg.type = "RegScore", pch = 22, bg="lightblue",
xlab = "log(centroid size)", ylab = "Regression score", cex=2)
preds <- shape.predictor(allom$GM$fitted, x = allom_plot$PredLine,
predmin = min(allom_plot$PredLine),
predmax = max(allom_plot$PredLine))
differences_shamani <- coordinates.difference(coordinates = preds$predmax,
reference = preds$predmin, type = "spherical")
ind <- dimnames(speciesgp$Petrogale_wilkinsi)[[3]]
pet_sym <- bilat.symmetry(speciesgp$Petrogale_wilkinsi, ind=ind, land.pairs = sym, object.sym=T, curves=slide)
gpa <- gpagen(speciesgp$Petrogale_wilkinsi)
size <- gpa$Csize
range(size)
allom <- procD.lm(pet_sym$symm.shape~log(size), iter=999); summary(allom)
allom_plot <- plot(allom, type = "regression", predictor = log(size),
reg.type = "RegScore", pch = 22, bg="lightblue",
xlab = "log(centroid size)", ylab = "Regression score", cex=2)
preds <- shape.predictor(allom$GM$fitted, x = allom_plot$PredLine,
predmin = min(allom_plot$PredLine),
predmax = max(allom_plot$PredLine))
differences_wilkinsi <- coordinates.difference(coordinates = preds$predmax,
reference = preds$predmin, type = "spherical")
ind <- dimnames(speciesgp$Petrogale_xanthopus)[[3]]
pet_sym <- bilat.symmetry(speciesgp$Petrogale_xanthopus, ind=ind, land.pairs = sym, object.sym=T, curves=slide)
gpa <- gpagen(speciesgp$Petrogale_xanthopus)
size <- gpa$Csize
range(size)
allom <- procD.lm(pet_sym$symm.shape~log(size), iter=999); summary(allom)
allom_plot <- plot(allom, type = "regression", predictor = log(size),
reg.type = "RegScore", pch = 22, bg="lightblue",
xlab = "log(centroid size)", ylab = "Regression score", cex=2)
preds <- shape.predictor(allom$GM$fitted, x = allom_plot$PredLine,
predmin = min(allom_plot$PredLine),
predmax = max(allom_plot$PredLine))
differences_xanthopus <- coordinates.difference(coordinates = preds$predmax,
reference = preds$predmin, type = "spherical")
meandiff <- abind::abind(differences_assimilis,differences_brachyotis,differences_concinna,differences_godmani,differences_herberti,differences_inornata,differences_lateralis,differences_mareeba,differences_mareeba,differences_penicillata,differences_persephone,differences_purpureicollis,differences_rothschildi,differences_shamani,differences_wilkinsi,differences_xanthopus)
differences_assimilis
diff.mat <- array(NA, dim=c(150,3,17))
diff.mat[,,1] <- differences_assimilis
diff.mat
diff.mat <- array(NA, dim=c(150,3,17))
diff.mat
differences_assimilis
diff.mat[,,1] <- differences_assimilis
species <- c(differences_assimilis,differences_brachyotis,differences_concinna,differences_godmani,differences_herberti,differences_inornata,differences_lateralis,differences_mareeba,differences_mareeba,differences_penicillata,differences_persephone,differences_purpureicollis,differences_rothschildi,differences_shamani,differences_wilkinsi,differences_xanthopus)
species
View(species)
species <- c("differences_assimilis","differences_brachyotis","differences_concinna","differences_godmani","differences_herberti","differences_inornata","differences_lateralis","differences_mareeba","differences_mareeba","differences_penicillata","differences_persephone","differences_purpureicollis","differences_rothschildi","differences_shamani","differences_wilkinsi","differences_xanthopus")
diff.mat <- array(NA, dim=c(150,3,17))
species
diffmat[,,i] <- species[i]
for (i in 1:17){
diffmat[,,i] <- species[i]
}
for (i in 1:17){
diff.mat[,,i] <- species[i]
}
diff.mat
diff.mat[,,i] <- species[1]
species[1]
diff.mat <- array(NA, dim=c(150,3,17))
diff.mat[,,1] <- differences_assimilis
diff.mat[,,1]
diff.mat[,,1]
diff.mat <- array(NA, dim=c(150,3,17))
diff.mat[,,1] <- differences_assimilis[1:150,1:3]
differences_assimilis[1:150,1:3]
differences_assimilis
differences_assimilis[c(1:150,1:3)]
differences_assimilis[c(1:150,1:3)]
differences_assimilis
differences_assimilis[[1]][c(1:150,1:3)]
diff.mat[,,1] <- differences_assimilis[[1]][c(1:150,1:3)]
diff.mat[,,1]
differences_assimilis[[1]]
matrix(differences_assimilis[[1]][c(1:150,1:3)])
differences_assimilis[[1]]
matrix(differences_assimilis[[1]][c(1:150,1:3)], 3,150)
matrix(differences_assimilis[[1]][c(1:150,1:3)],150,3)
matrix(differences_assimilis[[1]][c(1:150,1:3)],150,3)
differences_assimilis
matrix(differences_assimilis[[1]][c(1:150,1:3)],150,3)
differences_assimilis[[1]][c(1:150,1:3)]
differences_assimilis[[1]]
diff.mat <- array(NA, dim=c(150,3,17))
diff.mat[,,1] <- differences_assimilis[[1]]
diff.mat[,,1]
mean.diff <- mean(differences_assimilis[[1]],differences_brachyotis[[1]],differences_concinna[[1]],differences_godmani[[1]],differences_herberti[[1]],differences_inornata[[1]],differences_lateralis[[1]],differences_mareeba[[1]],differences_penicillata[[1]],differences_persephone[[1]],differences_purpureicollis[[1]],differences_rothschildi[[1]],differences_shamani[[1]],differences_wilkinsi[[1]],differences_xanthopus[[1]])
differences_assimilis[[1]]
differences_assimilis[[1]][150,3]
differences_assimilis[[1]][,]
mean(differences_assimilis[[1]],differences_brachyotis[[1]],differences_concinna[[1]],differences_godmani[[1]],differences_herberti[[1]],differences_inornata[[1]],differences_lateralis[[1]],differences_mareeba[[1]],differences_penicillata[[1]],differences_persephone[[1]],differences_purpureicollis[[1]],differences_rothschildi[[1]],differences_shamani[[1]],differences_wilkinsi[[1]],differences_xanthopus[[1]])
X <- list(differences_assimilis[[1]],differences_brachyotis[[1]],differences_concinna[[1]],differences_godmani[[1]],differences_herberti[[1]],differences_inornata[[1]],differences_lateralis[[1]],differences_mareeba[[1]],differences_penicillata[[1]],differences_persephone[[1]],differences_purpureicollis[[1]],differences_rothschildi[[1]],differences_shamani[[1]],differences_wilkinsi[[1]],differences_xanthopus[[1]])
X
Y <- do.call(cbind, X)
dim(X[[1]])
Y <- array(Y, dim=c(dim(X[[1]]), length(X)))
apply(Y, c(1, 2), mean, na.rm = TRUE)
mean.diff <- apply(Y, c(1, 2), mean, na.rm = TRUE)
dim=c(dim(X[[1]])
c(dim(X[[1]])
dim(X[[1]])
pet_sym <- bilat.symmetry(alldata, ind=ind, land.pairs = sym, object.sym=T, curves=slide)
ind <- dimnames(alldata)[[3]]
pet_sym <- bilat.symmetry(alldata, ind=ind, land.pairs = sym, object.sym=T, curves=slide)
meanshape <- mshape(pet_sym$symm.shape)
differences
differences[[1]][1:150]
mean.diff[1:150]
procrustes.var.plot(meanshape, meanshape, col = heat.colors, col.val = mean.diff[1:150], magnitude = 2, pt.size = 1)
mean.diff
differences_xanthopus
speciesgp
speciesgp[1]
speciesgp[1]
speciesgp$Petrogale_assimilis
setwd("//userMN/M/mitc0448/Desktop/Petrogale allometry R1 tests")
library(geomorph)
library(landvR)
load("allometry_tests.rda")
ind <- dimnames(alldata)[[3]]
pet_sym <- bilat.symmetry(alldata, ind=ind, land.pairs = sym, object.sym=T, curves=slide)
gpa <- gpagen(alldata)
size <- gpa$Csize
allom <- procD.lm(pet_sym$symm.shape~log(size), iter=999); summary(allom)
allom_plot <- plot(allom, type = "regression", predictor = log(size),
reg.type = "RegScore", pch = iconsPCA, bg=colsPCA,
xlab = "log(centroid size)", ylab = "Regression score", cex=2)
### intraspecific tests ###
speciesgp <- coords.subset(alldata, speciesnames)
ind <- dimnames(speciesgp$Petrogale_assimilis)[[3]]
pet_sym <- bilat.symmetry(speciesgp$Petrogale_assimilis, ind=ind, land.pairs = sym, object.sym=T, curves=slide)
gpa <- gpagen(speciesgp$Petrogale_assimilis)
size <- gpa$Csize
range(size)
allom <- procD.lm(pet_sym$symm.shape~log(size), iter=999); summary(allom)
setwd("C:/Workspace/github_repos/Petrogale_allometry")
library(geomorph)
library(landvR)
load("allometry_tests.rda")
ind <- dimnames(alldata)[[3]]
pet_sym <- bilat.symmetry(alldata, ind=ind, land.pairs = sym, object.sym=T, curves=slide)
gpa <- gpagen(alldata)
size <- gpa$Csize
allom <- procD.lm(pet_sym$symm.shape~log(size), iter=999); summary(allom)
allomspec <- procD.lm(pet_sym$symm.shape~log(size)*speciesnames, iter=999); summary(allomspec)
allomspec_plot <- plotAllometry(allomspec, size = size, logsz = TRUE,
method = "RegScore", pch = iconsPCA, bg=colsPCA, cex=2)
allomspec <- procD.lm(pet_sym$symm.shape~log(size)*speciesnames, iter=999); summary(allomspec)
pw<-pairwise(allomspec,groups=speciesnames, covariate = log(size))
View(pw)
pw$slopes
View(allomspec)
allomspec$coefficients
dim(allomspec$coefficients)
TestHOS <- function(shape, size, group, iter = 500, lm.fun) {
# Data frame
spp.gdf <- geomorph.data.frame(coords = pet_symm.shape, size = size, spp = speciesnames)
# Models
fit.unique <- lm.fun(coords ~ log(size) * spp, iter = iter, data = spp.gdf, RRPP = FALSE)  # unique allometries by spp
fit.common <- lm.fun(coords ~ log(size) + spp, iter = iter, data = spp.gdf, RRPP = FALSE)  # common allometries across spp (NULL HYPOTHESIS)
return(pairwise(fit.unique, fit.common, groups = spp.gdf$spp))
}
pw.comp <- TestHOS(shape, size, speciesnames, lm.fun = procD.lm)
TestHOS <- function(shape, size, group, iter = 500, lm.fun) {
# Data frame
spp.gdf <- geomorph.data.frame(coords = pet_sym$symm.shape, size = size, spp = speciesnames)
# Models
fit.unique <- lm.fun(coords ~ log(size) * spp, iter = iter, data = spp.gdf, RRPP = FALSE)  # unique allometries by spp
fit.common <- lm.fun(coords ~ log(size) + spp, iter = iter, data = spp.gdf, RRPP = FALSE)  # common allometries across spp (NULL HYPOTHESIS)
return(pairwise(fit.unique, fit.common, groups = spp.gdf$spp))
}
pw.comp <- TestHOS(shape, size, speciesnames, lm.fun = procD.lm)
pw.comp
pw.summary <- summary.pairwise(pw.comp, test.type = "VC", angle.type = "deg", confidence = 0.95)
pw.summary
actual.pw <- length(which(round(pw.summary$pairwise.tables$P, 3) < 0.01))
actual.pw
pw.summary$pairwise.tables$P
round(pw.summary$pairwise.tables$P, 3)
which(round(pw.summary$pairwise.tables$P, 3) < 0.01)
actual.pw <- length(which(round(pw.summary$pairwise.tables$P, 3) < 0.05))
actual.pw
which(round(pw.summary$pairwise.tables$P, 3) < 0.05)
pw.summary$pairwise.tables$P[actual.pw]
pw.summary$pairwise.tables$P[actual.pw]
actual.pw
pw.summary$pairwise.tables$P[which(round(pw.summary$pairwise.tables$P, 3) < 0.05)]
names(pw.summary$pairwise.tables$P)
rownames(pw.summary$pairwise.tables$P)
which(round(pw.summary$pairwise.tables$P, 3) < 0.05)
lm_temp <- NULL
xcoords <- vector()
ycoords <- vector ()
coeffs <- matrix(NA, 18,2)
coeffs <- matrix(NA, 18,2)
coeffs
fit <- procD.lm(pet_sym$symm.shape~log(size), iter=999)
plot1 <- plotAllometry(fit, size = size, logsz = TRUE,
method = "RegScore", pch = iconsPCA, bg=colsPCA, cex=2)
xcoords <- subset(log(size), speciesnames == levels (speciesnames)[i] )
for (i in 1: 18){
xcoords <- subset(log(size), speciesnames == levels (speciesnames)[i] )
ycoords <- subset(plot1$RegScore, speciesnames == levels (speciesnames)[i])
lm_temp <- lm(ycoords~xcoords)
coeffs[i,] <- lm_temp
}
coeffs <- matrix(NA, 17,2)
for (i in 1: 17){
xcoords <- subset(log(size), speciesnames == levels (speciesnames)[i] )
ycoords <- subset(plot1$RegScore, speciesnames == levels (speciesnames)[i])
lm_temp <- lm(ycoords~xcoords)
coeffs[i,] <- lm_temp
}
xcoords <- subset(log(size), speciesnames == levels (speciesnames)[1]
ycoords <- subset(plot1$RegScore, speciesnames == levels (speciesnames)[1]
xcoords <- subset(log(size), speciesnames == levels (speciesnames)[1] )
ycoords <- subset(plot1$RegScore, speciesnames == levels (speciesnames)[1])
lm_temp <- lm(ycoords~xcoords)
lm_temp
lm_temp[,1] <- lm(ycoords~xcoords)
lm_temp[1] <- lm(ycoords~xcoords)
lm_temp$coefficients
coeffs <- matrix(NA, 18,2)
for (i in 1: 18){
xcoords <- subset(log(size), speciesnames == levels (speciesnames)[i] )
ycoords <- subset(plot1$RegScore, speciesnames == levels (speciesnames)[i])
lm_temp <- lm(ycoords~xcoords)
coeffs[i,] <- lm_temp$coefficients
}
coeffs <- matrix(NA, 17,2)
for (i in 1: 17){
xcoords <- subset(log(size), speciesnames == levels (speciesnames)[i] )
ycoords <- subset(plot1$RegScore, speciesnames == levels (speciesnames)[i])
lm_temp <- lm(ycoords~xcoords)
coeffs[i,] <- lm_temp$coefficients
}
coeffs
c1 <- lm(plot1$RegScore~log(size))
coeffs[18,] <- c1$coefficients
coeffs2 <- rbind(coeffs, c1)
coeffs2 <- rbind(coeffs, c1$coefficients)
coeffs2
c1
plot1 <- plotAllometry(fit, size = size, logsz = TRUE,
method = "RegScore", pch = iconsPCA, bg=colsPCA, cex=2)
coeffs[1,]
for(i in 1:18){
abline(coeffs[i,])}
col <- c("lightblue","red","red4","purple","red4","purple","purple4","blue","green","lightblue","purple4","orange","turquoise","yellow","lightblue","red","orange")
col <- c("lightblue","red","red4","purple","red4","purple","purple4","blue","green","lightblue","purple4","orange","turquoise","yellow","lightblue","red","orange", "black")
for(i in 1:18){
abline(coeffs[i,]), col=col[i], lwd=2}
for(i in 1:18){
abline((coeffs[i,]), col=col[i], lwd=2)}
plot2 <- plot(plot1$RegScore~log(size), xlab = "log(cranial centroid size)", ylab="Shape regression score", method = "RegScore", pch = iconsPCA, bg=colsPCA, cex=1, main="shape~log(cranial centroid size)*species")
for(i in 1:18){
abline((coeffs[i,]), col=col[i], lwd=2)}
plot2 <- plot(plot1$RegScore~log(size), xlab = "log(cranial centroid size)", ylab="Shape regression score", method = "RegScore", pch = iconsPCA, bg=colsPCA, cex=1, main="shape~log(cranial centroid size)*species")
col <- c("lightblue","red","red4","purple","red4","purple","purple4","blue","green","lightblue","purple4","orange","turquoise","yellow","lightblue","red","orange", "hotpink")
for(i in 1:18){
abline((coeffs[i,]), col=col[i], lwd=2)}
plot2 <- plot(plot1$RegScore~log(size), xlab = "log(cranial centroid size)", ylab="Shape regression score", method = "RegScore", pch = iconsPCA, bg=colsPCA, cex=2, main="shape~log(cranial centroid size)")
plot2 <- plot(plot1$RegScore~log(size), xlab = "log(cranial centroid size)", ylab="Shape regression score", method = "RegScore", pch = iconsPCA, bg=colsPCA, cex=1)
for (i in 1: length(levels (speciesnames))){
xcoords <- subset(log(size), speciesnames == levels (speciesnames)[i] )
ycoords <- subset(plot1$RegScore, speciesnames == levels (speciesnames)[i])
lm_temp <- lm(ycoords~xcoords)
segments(min(xcoords), lm_temp$coefficients[1] + lm_temp$coefficients[2] *min(xcoords), max(xcoords), lm_temp$coefficients[1] + lm_temp$coefficients[2] *max(xcoords), lwd = 2, col= col[i])
}
abline(c1$coefficients)
abline(c1$coefficients, lwd=2)
comps <- matrix(NA,17, 17)
comps
coeffs <- matrix(NA, 17,2)
for (i in 1: 17){
xcoords <- subset(log(size), speciesnames == levels (speciesnames)[i] )
ycoords <- subset(plot1$RegScore, speciesnames == levels (speciesnames)[i])
lm_temp <- lm(ycoords~xcoords)
coeffs[i,] <- lm_temp$coefficients
}
coeffs2 <- rbind(coeffs, c1$coefficients)
comps <- matrix(NA,18, 18)
for(i in 1:18){
for (j in 1:18){
comps[i,j] <- coeffs
})
for(i in 1:18){
for (j in 1:18){
comps[i,j] <- atan(coeffs[i,2]-coeffs[j,2])/(1-coeffs[i,2]*coeffs[j,2])
}
}
coeffs[1,2]
coeffs
for(i in 1:18){
for (j in 1:18){
comps[i,j] <- atan(coeffs[i,2]-coeffs[j,2])/(1-coeffs[i,2]*coeffs[j,2])
}
}
comps <- matrix(NA,18, 18)
for(i in 1:18){
for (j in 1:18){
comps[i,j] <- atan(coeffs[i,2]-coeffs[j,2])/(1-coeffs[i,2]*coeffs[j,2])
}
}
angles <- matrix(NA,18, 18)
gradinets <- coeffs[,2]
gradients <- coeffs[,2]
gradients
for(i in 1:18){
for (j in 1:18){
comps[i,j] <- atan(gradients[i]-gradients[j])/(1-gradients[i]*gradients[j])
}
}
angles[i,j] <- atan(gradients[i]-gradients[j])/(1-gradients[i]*gradients[j])
for(i in 1:18){
for (j in 1:18){
angles[i,j] <- atan(gradients[i]-gradients[j])/(1-gradients[i]*gradients[j])
}
}
for(i in 1:18){
for (j in 1:18){
angles[i,j] <- atan(gradients[i]-gradients[j])/(1-gradients[i]*gradients[j])
}
}
angles
gradients[18]
gradients <- coeffs2[,2]
angles <- matrix(NA,18, 18)
for(i in 1:18){
for (j in 1:18){
angles[i,j] <- atan(gradients[i]-gradients[18])/(1-gradients[i]*gradients[j])
}
}
angles
for(i in 1:18){
for (j in 1:18){
angles[i,j] <- atand(gradients[i]-gradients[18])/(1-gradients[i]*gradients[j])
}
}
for(i in 1:18){
for (j in 1:18){
angles[i,j] <- atand(gradients[i]-gradients[18])/(1+gradients[i]*gradients[j])
}
}
for(i in 1:18){
for (j in 1:18){
angles[i,j] <- atan(gradients[i]-gradients[18])/(1+gradients[i]*gradients[j])
}
}
angles
gradients
for(i in 1:18){
for (j in 1:18){
angles[i,j] <- atan(gradients[i]-gradients[j])/(1+gradients[i]*gradients[j])
}
}
angles
angles_deg <- angles*180/pi
ngles_deg
angles_deg
fit <- procD.lm(pet_sym$symm.shape~log(size)*species, iter=999)
fit <- procD.lm(pet_sym$symm.shape~log(size)*speciesnames, iter=999)
plot1 <- plotAllometry(fit, size = size, logsz = TRUE,
method = "RegScore", pch = iconsPCA, bg=colsPCA, cex=2)
for (i in 1: 17){
xcoords <- subset(log(size), speciesnames == levels (speciesnames)[i] )
ycoords <- subset(plot1$RegScore, speciesnames == levels (speciesnames)[i])
lm_temp <- lm(ycoords~xcoords)
coeffs[i,] <- lm_temp$coefficients
}
c1 <- lm(plot1$RegScore~log(size))
coeffs2 <- rbind(coeffs, c1$coefficients)
col <- c("lightblue","red","red4","purple","red4","purple","purple4","blue","green","lightblue","purple4","orange","turquoise","yellow","lightblue","red","orange")
for(i in 1:18){
abline((coeffs[i,]), col=col[i], lwd=2)}
angles <- matrix(NA,18, 18)
gradients2 <- coeffs2[,2]
angles2 <- matrix(NA,18, 18)
for(i in 1:18){
for (j in 1:18){
angles2[i,j] <- atan(gradients2[i]-gradients2[j])/(1+gradients2[i]*gradients2[j])
}
}
angles_deg2 <- angles2*180/pi
angles_deg2
abline(c1$coefficients, lwd=2)
speciesnames[13]
speciesnames[1]
speciesnames
levels(speciesnames)[1]
levels(speciesnames)[13]
